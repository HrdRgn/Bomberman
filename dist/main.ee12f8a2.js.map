{"version":3,"sources":["main.js"],"names":["gameInterval","fieldY","fieldX","enemies","place","monsterPosition","workField","playerPosition","direction","lastDirection","bomb","freeField","monster","block","player","fire","box","startButton","document","getElementById","validate","name","info","min","max","alert","gameStart","i","Array","getRandom","Number","j","some","item","createField","innerText","style","visibility","setInterval","runningGame","map","array","createElement","innerHTML","join","appendChild","updateField","app","childNodes","indexOf","replaceChild","clearField","firstChild","remove","Math","round","random","updatePlayerPosition","monsterThinks","monsterMove","bombSequence","clearInterval","setTimeout","nextStepY","nextStepX","it","a","bombExplodes","y","x","index","indexCheck","find","addEventListener","e","value","keyName","key"],"mappings":"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","file":"main.ee12f8a2.js","sourceRoot":"../src","sourcesContent":["\"use strict\";\n\nconst monsterPosition = [];\nconst workField = [];\nconst playerPosition = [];\nconst direction = [0, 0];\nconst lastDirection = [0, 1];\nconst bomb = \"B&#8200;&#8200;\";\nconst freeField = \"&#8195;\";\nconst monster = \"M&#8202;\";\nconst block = \"&#9609;\";\nconst player = \"P&#8196;&#8202;\";\nconst fire = \"F&#8202;&#8197;&#8202;\";\nconst box = \"&#9618;&#8198;&#8202;\";\nvar gameInterval;\nvar fieldY;\nvar fieldX;\nvar enemies;\nvar place;\n\nconst startButton = document.getElementById(\"startButton\");\n\nfunction validate(name, info, min, max) {\n  if (info >= min && info <= max) {\n    return true;\n  } else {\n    alert(`Please input correct ${name} (between ${min} and ${max})`);\n    return false;\n  }\n}\n\nstartButton.addEventListener(\"click\", (e) => {\n  fieldX = Math.round(Number(document.getElementById(\"fieldX\").value)) || 30;\n  fieldY = Math.round(Number(document.getElementById(\"fieldY\").value)) || 20;\n  enemies = Number(document.getElementById(\"enemies\").value) || 10;\n  if (\n    validate(\"fieldX\", fieldX, 10, 30) &&\n    validate(\"fieldY\", fieldY, 10, 30) &&\n    validate(\"enemies\", enemies, 1, 15)\n  ) {\n    gameStart();\n  }\n});\n\nfunction gameStart() {\n  for (let i = 0; i < enemies; i++) {\n    monsterPosition[i] = new Array(3);\n    monsterPosition[i][0] = getRandom(1, fieldY);\n    monsterPosition[i][1] = getRandom(1, fieldX);\n    monsterPosition[i][2] = \"Active\";\n  }\n\n  playerPosition[0] = Number(getRandom(1, fieldY));\n  playerPosition[1] = Number(getRandom(1, fieldX));\n  playerPosition[2] = \"Alive\";\n\n  for (let i = 0; i < fieldY + 2; i++) {\n    workField[i] = new Array(fieldX + 2);\n    for (let j = 0; j < fieldX + 2; j++) {\n      if (i === 0 || j === 0 || i === fieldY + 1 || j === fieldX + 1) {\n        workField[i][j] = block;\n      } else {\n        if (monsterPosition.some((item) => item[0] === i && item[1] === j)) {\n          workField[i][j] = monster;\n        } else if (getRandom(0, 0.565)) {\n          workField[i][j] = block;\n        } else if (getRandom(1, 1.4)) {\n          workField[i][j] = box;\n        } else {\n          workField[i][j] = freeField;\n        }\n      }\n    }\n  }\n\n  workField[playerPosition[0]][playerPosition[1]] = player;\n  createField();\n  document.getElementById(\"status\").innerText = playerPosition[2];\n  document.getElementById(\"startButton\").style.visibility = \"hidden\";\n  gameInterval = setInterval(() => runningGame(), 500);\n}\n\nfunction createField() {\n  workField.map((item) => {\n    const array = document.createElement(\"div\");\n    array.innerHTML = item.join(\"\");\n    document.getElementById(\"app\").appendChild(array);\n  });\n}\n\nfunction updateField() {\n  workField.map((item) => {\n    const array = document.createElement(\"div\");\n    array.innerHTML = item.join(\"\");\n    const app = document.getElementById(\"app\").childNodes[\n      workField.indexOf(item)\n    ];\n    document.getElementById(\"app\").replaceChild(array, app);\n  });\n}\n\nfunction clearField() {\n  workField.map(() => {\n    document.getElementById(\"app\").firstChild.remove();\n  });\n}\n\nfunction getRandom(min, max) {\n  return Math.round(Math.random() * (max - min) + min);\n}\n\nfunction runningGame() {\n  updatePlayerPosition();\n\n  monsterThinks();\n\n  monsterMove();\n\n  bombSequence();\n\n  document.getElementById(\"status\").innerText = playerPosition[2];\n\n  updateField();\n\n  if (!monsterPosition.some((item) => item[2] !== \"Dead\")) {\n    document.getElementById(\"status\").innerText = \"Victory\";\n  }\n  if (playerPosition[2] === \"Killed\") {\n    document.getElementById(\"status\").innerText = \"Defeat\";\n  }\n  if (\n    document.getElementById(\"status\").innerText === \"Defeat\" ||\n    document.getElementById(\"status\").innerText === \"Victory\"\n  ) {\n    clearInterval(gameInterval);\n    setTimeout(() => {\n      clearField();\n      document.getElementById(\"startButton\").style.visibility = \"visible\";\n    }, 2500);\n  }\n}\n\nfunction monsterThinks() {\n  monsterPosition.map((item) => {\n    if (item[2] !== \"Dead\") {\n      let nextStepY = item[0] + getRandom(-1, 1);\n      let nextStepX = item[1] + getRandom(-1.49, 1.49);\n      if (workField[item[0]][item[1]] === monster) {\n        workField[item[0]][item[1]] = freeField;\n      }\n      if (\n        nextStepY > 0 &&\n        nextStepY < fieldY &&\n        !monsterPosition.some(\n          (it) => it[0] === nextStepY && it[1] === item[1]\n        ) &&\n        workField[nextStepY][item[1]] !== block &&\n        workField[nextStepY][item[1]] !== box &&\n        workField[nextStepY][item[1]] !== bomb\n      ) {\n        item[0] = nextStepY;\n      } else if (\n        nextStepX > 0 &&\n        nextStepX < fieldX &&\n        !monsterPosition.some((it) => it[1] === nextStepX) &&\n        workField[item[0]][nextStepX] !== block &&\n        workField[item[0]][nextStepX] !== box &&\n        workField[item[0]][nextStepX] !== bomb\n      ) {\n        item[1] = nextStepX;\n      }\n    }\n  });\n}\nfunction monsterMove() {\n  monsterPosition.map((item) => {\n    let a = workField[item[0]][item[1]];\n    if (a === fire) {\n      item[2] = \"Dead\";\n    } else if (item[2] !== \"Dead\") {\n      if (a === player) {\n        playerPosition[2] = \"Killed\";\n        workField[item[0]][item[1]] = monster;\n      } else {\n        workField[item[0]][item[1]] = monster;\n      }\n    }\n  });\n}\n\nfunction updatePlayerPosition() {\n  if (playerPosition[2] === \"Alive\") {\n    let a =\n      workField[playerPosition[0] + direction[0]][\n        playerPosition[1] + direction[1]\n      ];\n    if (a !== block && a !== bomb && a !== box) {\n      if (a === monster || a === fire) {\n        playerPosition[2] = \"Killed\";\n      }\n      if (direction[0] !== 0 || direction[1] !== 0) {\n        workField[playerPosition[0]][playerPosition[1]] = freeField;\n        playerPosition[0] += direction[0];\n        playerPosition[1] += direction[1];\n        workField[playerPosition[0]][playerPosition[1]] = player;\n        lastDirection[0] = direction[0];\n        lastDirection[1] = direction[1];\n      }\n\n      direction[0] = 0;\n      direction[1] = 0;\n    }\n  }\n}\n\nfunction bombSequence() {\n  if (place) {\n    if (\n      workField[playerPosition[0] + lastDirection[0]][\n        playerPosition[1] + lastDirection[1]\n      ] !== block &&\n      workField[playerPosition[0] + lastDirection[0]][\n        playerPosition[1] + lastDirection[1]\n      ] !== box\n    ) {\n      workField[playerPosition[0] + lastDirection[0]][\n        playerPosition[1] + lastDirection[1]\n      ] = bomb;\n      bombExplodes(\n        playerPosition[0] + lastDirection[0],\n        playerPosition[1] + lastDirection[1]\n      );\n    }\n  }\n  place = false;\n}\n\nfunction bombExplodes(y, x) {\n  setTimeout(() => {\n    const bombZone = [\n      [y + 1, x],\n      [y + 2, x],\n      [y + 3, x],\n      [y - 1, x],\n      [y - 2, x],\n      [y - 3, x],\n      [y, x + 1],\n      [y, x + 2],\n      [y, x + 3],\n      [y, x - 1],\n      [y, x - 2],\n      [y, x - 3],\n    ];\n\n    bombZone.map((item, index, array) => {\n      let a = array[index - 1];\n      let indexCheck = [0, 3, 6, 9].some((it) => it === index);\n\n      if (\n        item[0] > 0 &&\n        item[0] < fieldY + 1 &&\n        item[1] > 0 &&\n        item[1] < fieldX + 1\n      ) {\n        if (\n          (indexCheck && workField[item[0]][item[1]] !== block) ||\n          (!indexCheck &&\n            workField[a[0]][a[1]] === fire &&\n            workField[item[0]][item[1]] !== block)\n        ) {\n          workField[item[0]][item[1]] = fire;\n          if (workField[item[0]][item[1]] === player) {\n            playerPosition[2] = \"Killed\";\n            workField[item[0]][item[1]] = fire;\n          }\n          if (workField[item[0]][item[1]] === monster) {\n            monsterPosition.find(\n              (it) => it[0] === item[0] && it[1] === item[1]\n            )[2] = \"Dead\";\n            workField[item[0]][item[1]] = fire;\n          }\n          setTimeout(() => {\n            if (\n              workField[item[0]][item[1]] !== bomb &&\n              workField[item[0]][item[1]] !== block\n            ) {\n              workField[item[0]][item[1]] = freeField;\n            }\n          }, 1500);\n        }\n      }\n    });\n    workField[y][x] = fire;\n    setTimeout(() => {\n      workField[y][x] = freeField;\n    }, 1500);\n  }, 3000);\n}\n\ndocument.addEventListener(\"keydown\", (e) => {\n  const keyName = e.key;\n\n  switch (keyName) {\n    case \"w\": {\n      direction[0] = -1;\n      direction[1] = 0;\n      break;\n    }\n    case \"a\": {\n      direction[0] = 0;\n      direction[1] = -1;\n      break;\n    }\n    case \"s\": {\n      direction[0] = 1;\n      direction[1] = 0;\n      break;\n    }\n    case \"d\": {\n      direction[0] = 0;\n      direction[1] = 1;\n      break;\n    }\n    case \" \": {\n      direction[0] = 0;\n      direction[1] = 0;\n      place = true;\n      break;\n    }\n  }\n});\n"]}